<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courses - CI-NDA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="src/index.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#fef2f2',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-950 text-white min-h-screen">
    <!-- Navigation -->
    <nav class="fixed top-0 w-full bg-gray-950/95 backdrop-blur-sm border-b border-gray-800 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="/" class="text-2xl font-bold text-red-600 tracking-wide">CI-NDA</a>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="/dashboard.html" class="nav-item nav-item-inactive">Dashboard</a>
                    <a href="/courses.html" class="nav-item nav-item-active">Courses</a>
                    <a href="/opportunities.html" class="nav-item nav-item-inactive">Opportunities</a>
                    <a href="/portfolios.html" class="nav-item nav-item-inactive">Portfolios</a>
                    <a href="/mentorship.html" class="nav-item nav-item-inactive">Mentorship</a>
                    <button onclick="Auth.logout()" class="btn-ghost">Logout</button>
                </div>
                <div class="md:hidden flex items-center">
                    <button onclick="toggleMobileMenu()" class="text-gray-400 hover:text-white">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-gray-900 border-t border-gray-800">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="/dashboard.html" class="block px-3 py-2 text-gray-400 hover:text-white">Dashboard</a>
                <a href="/courses.html" class="block px-3 py-2 text-red-600 font-medium">Courses</a>
                <a href="/opportunities.html" class="block px-3 py-2 text-gray-400 hover:text-white">Opportunities</a>
                <a href="/portfolios.html" class="block px-3 py-2 text-gray-400 hover:text-white">Portfolios</a>
                <a href="/mentorship.html" class="block px-3 py-2 text-gray-400 hover:text-white">Mentorship</a>
                <button onclick="Auth.logout()" class="block w-full text-left px-3 py-2 text-gray-400 hover:text-white">Logout</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-24 pb-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-4xl font-bold text-white mb-4">Film Courses</h1>
                <p class="text-gray-400 text-lg max-w-2xl">
                    Enhance your filmmaking skills with our curated selection of courses. From beginner fundamentals to advanced techniques.
                </p>
            </div>

            <!-- Search and Filters -->
            <div class="mb-8 space-y-4">
                <div class="flex flex-col sm:flex-row gap-4">
                    <div class="flex-1 relative">
                        <input type="text" 
                               id="search-input" 
                               placeholder="Search courses..." 
                               class="search-input">
                        <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </div>
                    <select id="category-filter" class="form-input w-full sm:w-auto">
                        <option value="">All Categories</option>
                        <option value="directing">Directing</option>
                        <option value="cinematography">Cinematography</option>
                        <option value="editing">Editing</option>
                        <option value="screenwriting">Screenwriting</option>
                        <option value="sound">Sound Design</option>
                        <option value="production">Production</option>
                    </select>
                    <select id="level-filter" class="form-input w-full sm:w-auto">
                        <option value="">All Levels</option>
                        <option value="beginner">Beginner</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="advanced">Advanced</option>
                    </select>
                </div>
                
                <!-- Filter Tags -->
                <div class="flex flex-wrap gap-2">
                    <button onclick="filterCourses('all')" class="filter-tag active" data-filter="all">All</button>
                    <button onclick="filterCourses('popular')" class="filter-tag" data-filter="popular">Popular</button>
                    <button onclick="filterCourses('new')" class="filter-tag" data-filter="new">New</button>
                    <button onclick="filterCourses('free')" class="filter-tag" data-filter="free">Free</button>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loading" class="hidden text-center py-12">
                <div class="spinner w-8 h-8 mx-auto mb-4"></div>
                <p class="text-gray-400">Loading courses...</p>
            </div>

            <!-- Courses Grid -->
            <div id="courses-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Course cards will be populated here -->
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="hidden text-center py-12">
                <svg class="w-16 h-16 text-gray-600 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                </svg>
                <h3 class="text-xl font-semibold text-gray-400 mb-2">No courses found</h3>
                <p class="text-gray-500">Try adjusting your search criteria or filters.</p>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="public/js/global.js"></script>
    <script>
        let courses = [];
        let filteredCourses = [];
        let currentFilters = {
            search: '',
            category: '',
            level: '',
            tag: 'all'
        };

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication
            if (!Auth.redirectIfNotAuthenticated()) return;

            // Load courses
            loadCourses();

            // Setup event listeners
            setupEventListeners();
        });

        function setupEventListeners() {
            // Search input
            const searchInput = document.getElementById('search-input');
            searchInput.addEventListener('input', Search.debounce(function(e) {
                currentFilters.search = e.target.value;
                filterAndDisplayCourses();
            }, 300));

            // Filter selects
            document.getElementById('category-filter').addEventListener('change', function(e) {
                currentFilters.category = e.target.value;
                filterAndDisplayCourses();
            });

            document.getElementById('level-filter').addEventListener('change', function(e) {
                currentFilters.level = e.target.value;
                filterAndDisplayCourses();
            });
        }

        async function loadCourses() {
            try {
                document.getElementById('loading').classList.remove('hidden');

                const response = await ApiClient.get('/api/courses');
                if (response.success) {
                    courses = response.courses || [];
                    filteredCourses = [...courses];
                    displayCourses();
                } else {
                    Toast.error('Failed to load courses');
                }
            } catch (error) {
                console.error('Error loading courses:', error);
                Toast.error('Failed to load courses: ' + (error.message || 'Unknown error'));
            } finally {
                document.getElementById('loading').classList.add('hidden');
            }
        }

        function filterCourses(tag) {
            // Update active filter tag
            document.querySelectorAll('.filter-tag').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${tag}"]`).classList.add('active');

            currentFilters.tag = tag;
            filterAndDisplayCourses();
        }

        function filterAndDisplayCourses() {
            filteredCourses = courses.filter(course => {
                // Search filter
                if (currentFilters.search) {
                    const searchTerm = currentFilters.search.toLowerCase();
                    if (!course.title.toLowerCase().includes(searchTerm) &&
                        !course.description.toLowerCase().includes(searchTerm) &&
                        !course.instructor.toLowerCase().includes(searchTerm)) {
                        return false;
                    }
                }

                // Category filter
                if (currentFilters.category && course.category !== currentFilters.category) {
                    return false;
                }

                // Level filter
                if (currentFilters.level && course.level !== currentFilters.level) {
                    return false;
                }

                // Tag filter
                if (currentFilters.tag !== 'all') {
                    switch (currentFilters.tag) {
                        case 'popular':
                            return course.enrolled_count > 50;
                        case 'new':
                            const courseDate = new Date(course.created_at);
                            const thirtyDaysAgo = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);
                            return courseDate > thirtyDaysAgo;
                        case 'free':
                            return course.price === 0 || course.price === '0';
                    }
                }

                return true;
            });

            displayCourses();
        }

        function displayCourses() {
            const grid = document.getElementById('courses-grid');
            const emptyState = document.getElementById('empty-state');

            if (filteredCourses.length === 0) {
                grid.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');
            
            grid.innerHTML = filteredCourses.map(course => `
                <div class="card hover:scale-105 transition-transform duration-200">
                    <div class="aspect-w-16 aspect-h-9 mb-4">
                        <img src="${course.thumbnail || '/api/placeholder/400/225'}" 
                             alt="${course.title}" 
                             class="w-full h-48 object-cover rounded-lg">
                    </div>
                    
                    <div class="space-y-3">
                        <!-- Course header -->
                        <div class="flex items-start justify-between">
                            <h3 class="font-semibold text-white text-lg leading-tight">${course.title}</h3>
                            <span class="status-badge ${course.price === 0 ? 'status-success' : 'status-info'} text-xs ml-2">
                                ${course.price === 0 ? 'Free' : '$' + course.price}
                            </span>
                        </div>

                        <!-- Course meta -->
                        <div class="flex items-center space-x-4 text-sm text-gray-400">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                                ${course.instructor}
                            </span>
                        </div>

                        <!-- Description -->
                        <p class="text-gray-300 text-sm line-clamp-2">${course.description}</p>

                        <!-- Stats -->
                        <div class="flex items-center justify-between pt-2 border-t border-gray-800">
                            <div class="flex items-center space-x-4 text-xs text-gray-500">
                                <span>${course.enrolled_count || 0} enrolled</span>
                                <span class="status-badge status-${course.level === 'beginner' ? 'success' : course.level === 'intermediate' ? 'warning' : 'error'}">
                                    ${course.level}
                                </span>
                            </div>
                            <button onclick="enrollInCourse(${course.id})" 
                                    class="btn-primary text-xs px-3 py-1">
                                Enroll
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function enrollInCourse(courseId) {
            try {
                const response = await ApiClient.post(`/api/courses/${courseId}/enroll`);

                if (response.success) {
                    Toast.success('Successfully enrolled in course!');
                    
                    // Update course enrollment count
                    const course = courses.find(c => c.id == courseId);
                    if (course) {
                        course.enrolled_count = (course.enrolled_count || 0) + 1;
                        displayCourses();
                    }
                } else {
                    Toast.error(response.message || 'Failed to enroll in course');
                }
            } catch (error) {
                console.error('Enrollment error:', error);
                Toast.error('Failed to enroll: ' + (error.message || 'Unknown error'));
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        // Add filter tag styles
        const style = document.createElement('style');
        style.textContent = `
            .filter-tag {
                padding: 8px 16px;
                font-size: 14px;
                border: 1px solid #374151;
                border-radius: 9999px;
                color: #9CA3AF;
                background: transparent;
                transition: all 0.2s;
                cursor: pointer;
            }
            .filter-tag:hover {
                color: white;
                border-color: #6B7280;
            }
            .filter-tag.active {
                background: #EF4444;
                border-color: #EF4444;
                color: white;
            }
            .line-clamp-2 {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>

        .nav-links a:hover {
            color: #b3b3b3;
        }

        .main-content {
            padding: 100px 50px 50px;
        }

        .page-header {
            margin-bottom: 40px;
        }

        .page-header h1 {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .page-header p {
            font-size: 18px;
            color: #b3b3b3;
            max-width: 800px;
        }

        .filter-section {
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px;
            background: #2a2a2a;
            border: none;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }

        .filter-btn:hover, .filter-btn.active {
            background: #e50914;
        }

        .courses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .course-card {
            background: #2a2a2a;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .course-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 30px rgba(229, 9, 20, 0.3);
        }

        .course-image {
            width: 100%;
            height: 200px;
            position: relative;
            overflow: hidden;
            background: #1a1a1a;
        }

        .course-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .course-card:hover .course-image img {
            transform: scale(1.1);
        }

        .course-image::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.7) 100%);
        }

        .course-content {
            padding: 20px;
        }

        .course-category {
            display: inline-block;
            padding: 4px 12px;
            background: #e50914;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .course-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .course-instructor {
            font-size: 14px;
            color: #b3b3b3;
            margin-bottom: 10px;
        }

        .course-description {
            font-size: 14px;
            color: #999;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .course-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 1px solid #3a3a3a;
        }

        .course-duration {
            font-size: 13px;
            color: #46d369;
        }

        .course-level {
            font-size: 13px;
            padding: 4px 10px;
            background: #3a3a3a;
            border-radius: 3px;
        }

        .enroll-btn {
            width: 100%;
            padding: 12px;
            background: #e50914;
            border: none;
            color: white;
            font-size: 16px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 15px;
            transition: background 0.3s;
        }

        .enroll-btn:hover {
            background: #f40612;
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 20px;
            }

            .main-content {
                padding: 100px 20px 50px;
            }

            .page-header h1 {
                font-size: 32px;
            }

            .courses-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Additional styles for dynamic content */
        .course-overlay {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .course-price {
            color: #e50914;
        }

        .enroll-btn.enrolled {
            background: #28a745;
            cursor: not-allowed;
        }

        .enroll-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .error-message {
            text-align: center;
            padding: 40px;
            background: #2a1a1a;
            border-radius: 8px;
            margin: 20px;
            grid-column: 1 / -1;
        }

        .error-message h3 {
            color: #ff6b6b;
            margin-bottom: 10px;
        }

        .retry-btn {
            background: #e50914;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 15px;
        }

        .retry-btn:hover {
            background: #b8070f;
        }

        .no-courses {
            text-align: center;
            padding: 40px;
            color: #888;
            grid-column: 1 / -1;
            font-size: 18px;
        }

        /* Search and auth styles */
        .search-container {
            position: relative;
            max-width: 300px;
        }

        #search-input {
            width: 100%;
            padding: 8px 15px;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 20px;
            color: white;
            font-size: 14px;
        }

        #search-input:focus {
            outline: none;
            border-color: #e50914;
        }

        #search-input::placeholder {
            color: #888;
        }

        .auth-buttons {
            display: flex;
            gap: 15px;
        }

        .auth-buttons a {
            padding: 8px 16px;
            background: #e50914;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background 0.3s;
            font-size: 14px;
        }

        .auth-buttons a:hover {
            background: #b8070f;
        }

        .user-nav {
            display: none;
            align-items: center;
            gap: 15px;
        }

        .user-nav a {
            color: white;
            text-decoration: none;
            font-size: 14px;
        }

        .user-nav a:hover {
            color: #e50914;
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background-size: cover;
            background-position: center;
            background-color: #444;
        }

        .user-name {
            font-size: 14px;
            max-width: 100px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
    </style>
</head>
<body>
<script src="public/js/auth-utils.js"></script>
<script src="public/js/api.js"></script>
<script src="public/js/api-init.js"></script>
    <nav class="navbar">
        <div class="logo">Ci-NDA</div>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="courses.html" style="color: #e50914;">Courses</a>
            <a href="opportunities.html">Opportunities</a>
            <a href="mentorship.html">Mentorship</a>
            <a href="portfolios.html">Portfolios</a>
            
            <!-- Search functionality -->
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Search courses...">
            </div>
        </div>

        <!-- Authentication buttons for non-logged in users -->
        <div class="auth-buttons">
            <a href="authentication.html">Sign In</a>
            <a href="authentication.html">Register</a>
        </div>

        <!-- User navigation for logged in users -->
        <div class="user-nav">
            <div class="user-avatar"></div>
            <span class="user-name">User</span>
            <a href="profile.html">Profile</a>
            <a href="#" onclick="logout()">Logout</a>
        </div>
    </nav>

    <div class="main-content">
        <div class="page-header">
            <h1>Film Courses & Training</h1>
            <p>Master the art of filmmaking with industry-leading courses taught by award-winning professionals. From beginner to advanced, find the perfect course to elevate your skills.</p>
        </div>

        <div class="filter-section">
            <button class="filter-btn active">All Courses</button>
            <button class="filter-btn">Beginner</button>
            <button class="filter-btn">Intermediate</button>
            <button class="filter-btn">Advanced</button>
            <button class="filter-btn">Cinematography</button>
            <button class="filter-btn">Editing</button>
            <button class="filter-btn">Directing</button>
            <button class="filter-btn">Sound Design</button>
        </div>

        <div class="courses-grid">
            <div class="course-card">
                <div class="course-image">
                    <img src="d.jpeg" alt="Cinematography Course">
                </div>
                <div class="course-content">
                    <span class="course-category">CINEMATOGRAPHY</span>
                    <h3 class="course-title">Introduction to Cinematography</h3>
                    <p class="course-instructor">By Roger Deakins</p>
                    <p class="course-description">Master the fundamentals of camera work, lighting composition, and visual storytelling techniques used in professional film production.</p>
                    <div class="course-meta">
                        <span class="course-duration">12 weeks</span>
                        <span class="course-level">Beginner</span>
                    </div>
                    <button class="enroll-btn">Enroll Now</button>
                </div>
            </div>

            <div class="course-card">
                <div class="course-image">
                    <img src="n.jpg" alt="Film Editing Course">
                </div>
                <div class="course-content">
                    <span class="course-category">EDITING</span>
                    <h3 class="course-title">Film Editing Masterclass</h3>
                    <p class="course-instructor">By Thelma Schoonmaker</p>
                    <p class="course-description">Learn professional editing techniques, pacing, rhythm, and how to craft compelling narratives in post-production.</p>
                    <div class="course-meta">
                        <span class="course-duration">8 weeks</span>
                        <span class="course-level">Intermediate</span>
                    </div>
                    <button class="enroll-btn">Enroll Now</button>
                </div>
            </div>

            <div class="course-card">
                <div class="course-image">
                    <img src="ik.jpeg" alt="Directing Course">
                </div>
                <div class="course-content">
                    <span class="course-category">DIRECTING</span>
                    <h3 class="course-title">Directing Actors</h3>
                    <p class="course-instructor">By Martin Scorsese</p>
                    <p class="course-description">Discover how to communicate with actors, block scenes effectively, and bring out authentic performances on camera.</p>
                    <div class="course-meta">
                        <span class="course-duration">10 weeks</span>
                        <span class="course-level">Advanced</span>
                    </div>
                    <button class="enroll-btn">Enroll Now</button>
                </div>
            </div>

            <div class="course-card">
                <div class="course-image">
                    <img src="yh.jpg" alt="Sound Design Course">
                </div>
                <div class="course-content">
                    <span class="course-category">SOUND DESIGN</span>
                    <h3 class="course-title">Sound Design for Film</h3>
                    <p class="course-instructor">By Ben Burtt</p>
                    <p class="course-description">Create immersive audio experiences through sound effects, foley, dialogue editing, and mixing techniques.</p>
                    <div class="course-meta">
                        <span class="course-duration">6 weeks</span>
                        <span class="course-level">Intermediate</span>
                    </div>
                    <button class="enroll-btn">Enroll Now</button>
                </div>
            </div>

            <div class="course-card">
                <div class="course-image">
                    <img src="c.jpg" alt="Screenwriting Course">
                </div>
                <div class="course-content">
                    <span class="course-category">SCREENWRITING</span>
                    <h3 class="course-title">Screenwriting Essentials</h3>
                    <p class="course-instructor">By Aaron Sorkin</p>
                    <p class="course-description">Craft compelling narratives, develop memorable characters, and master screenplay structure and dialogue.</p>
                    <div class="course-meta">
                        <span class="course-duration">14 weeks</span>
                        <span class="course-level">Beginner</span>
                    </div>
                    <button class="enroll-btn">Enroll Now</button>
                </div>
            </div>

            <div class="course-card">
                <div class="course-image">
                    <img src="cx.jpeg" alt="Lighting Course">
                </div>
                <div class="course-content">
                    <span class="course-category">LIGHTING</span>
                    <h3 class="course-title">Advanced Lighting Techniques</h3>
                    <p class="course-instructor">By Emmanuel Lubezki</p>
                    <p class="course-description">Master natural and artificial lighting setups, color temperature, and creating mood through illumination.</p>
                    <div class="course-meta">
                        <span class="course-duration">9 weeks</span>
                        <span class="course-level">Advanced</span>
                    </div>
                    <button class="enroll-btn">Enroll Now</button>
                </div>
            </div>

            <div class="course-card">
                <div class="course-image">
                    <img src="t.jpeg" alt="Production Design Course">
                </div>
                <div class="course-content">
                    <span class="course-category">PRODUCTION DESIGN</span>
                    <h3 class="course-title">Production Design & Art Direction</h3>
                    <p class="course-instructor">By Hannah Beachler</p>
                    <p class="course-description">Learn to create visually stunning worlds, design sets, and collaborate with directors to realize their vision.</p>
                    <div class="course-meta">
                        <span class="course-duration">11 weeks</span>
                        <span class="course-level">Intermediate</span>
                    </div>
                    <button class="enroll-btn">Enroll Now</button>
                </div>
            </div>

            <div class="course-card">
                <div class="course-image">
                    <img src="aa.jpeg" alt="Color Grading Course">
                </div>
                <div class="course-content">
                    <span class="course-category">COLOR GRADING</span>
                    <h3 class="course-title">Color Grading & Finishing</h3>
                    <p class="course-instructor">By Walter Volpatto</p>
                    <p class="course-description">Master DaVinci Resolve and industry-standard color grading workflows to achieve cinematic looks.</p>
                    <div class="course-meta">
                        <span class="course-duration">7 weeks</span>
                        <span class="course-level">Advanced</span>
                    </div>
                    <button class="enroll-btn">Enroll Now</button>
                </div>
            </div>

            <div class="course-card">
                <div class="course-image">
                    <img src="tr.jpg" alt="Documentary Filmmaking Course">
                </div>
                <div class="course-content">
                    <span class="course-category">DOCUMENTARY</span>
                    <h3 class="course-title">Documentary Filmmaking</h3>
                    <p class="course-instructor">By Ken Burns</p>
                    <p class="course-description">Explore the art of non-fiction storytelling, interview techniques, and ethical considerations in documentary work.</p>
                    <div class="course-meta">
                        <span class="course-duration">10 weeks</span>
                        <span class="course-level">Beginner</span>
                    </div>
                    <button class="enroll-btn">Enroll Now</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const filterBtns = document.querySelectorAll('.filter-btn');
        filterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                filterBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });
        let allCourses = [];

async function loadCourses(filter = null) {
  try {
    const filters = {};
    if (filter && filter !== 'All Courses') {
      if (['Beginner', 'Intermediate', 'Advanced'].includes(filter)) {
        filters.level = filter;
      } else {
        filters.category = filter;
      }
    }

    const courses = await api.getCourses(filters);
    allCourses = courses;
    renderCourses(courses);
  } catch (error) {
    console.error('Error loading courses:', error);
    alert('Failed to load courses. Please refresh the page.');
  }
}

async function loadCourses(category = '') {
  try {
    const filters = {};
    
    if (category && category !== 'All Categories') {
      // Map frontend filter names to backend categories
      const categoryMap = {
        'Cinematography': 'CINEMATOGRAPHY',
        'Editing': 'EDITING',
        'Directing': 'DIRECTING',
        'Sound Design': 'SOUND DESIGN',
        'Screenwriting': 'SCREENWRITING',
        'Lighting': 'LIGHTING',
        'Production Design': 'PRODUCTION DESIGN',
        'Color Grading': 'COLOR GRADING',
        'Documentary': 'DOCUMENTARY'
      };
      
      filters.category = categoryMap[category] || category.toUpperCase();
    }

    const response = await api.getCourses(filters);
    
    if (response.success) {
      renderCourses(response.courses || []);
    } else {
      console.error('Failed to load courses:', response.message);
      showError('Failed to load courses: ' + response.message);
    }
  } catch (error) {
    console.error('Error loading courses:', error);
    showError('Failed to load courses. Please check your connection.');
  }
}

function renderCourses(courses) {
  const grid = document.querySelector('.courses-grid');
  if (!grid) return;

  if (courses.length === 0) {
    grid.innerHTML = '<div class="no-courses">No courses found for the selected category.</div>';
    return;
  }

  grid.innerHTML = courses.map(course => `
    <div class="course-card" data-course-id="${course.id}">
      <div class="course-image">
        <img src="${course.image || 'https://images.unsplash.com/photo-1533929736458-ca588d08c8be?w=600&q=80'}" 
             alt="${course.title}" 
             onerror="this.src='https://images.unsplash.com/photo-1533929736458-ca588d08c8be?w=600&q=80'">
        <div class="course-overlay">
          <span class="course-price">${course.price > 0 ? '$' + course.price : 'Free'}</span>
        </div>
      </div>
      <div class="course-content">
        <span class="course-category">${course.category}</span>
        <h3 class="course-title">${course.title}</h3>
        <p class="course-instructor">By ${course.instructor?.name || 'Unknown Instructor'}</p>
        <p class="course-description">${course.description}</p>
        <div class="course-meta">
          <span class="course-duration">${course.duration || 'Self-paced'}</span>
          <span class="course-level">${course.level}</span>
          <span class="course-students">${course.enrolledStudents || 0} students</span>
        </div>
        <button class="enroll-btn ${course.isEnrolled ? 'enrolled' : ''}" 
                onclick="enrollCourse('${course.id}')"
                ${course.isEnrolled ? 'disabled' : ''}>
          ${course.isEnrolled ? 'Enrolled ✓' : 'Enroll Now'}
        </button>
      </div>
    </div>
  `).join('');
}

async function enrollCourse(courseId) {
  if (!localStorage.getItem('authToken')) {
    alert('Please sign in to enroll in courses');
    window.location.href = 'authentication.html';
    return;
  }

  try {
    const button = event.target;
    const originalText = button.textContent;
    button.textContent = 'Enrolling...';
    button.disabled = true;

    const response = await api.enrollInCourse(courseId);
    
    if (response.success) {
      button.textContent = 'Enrolled ✓';
      button.classList.add('enrolled');
      alert('✅ Successfully enrolled in course!');
      
      // Optionally redirect to course page or update UI
      // window.location.href = `course-detail.html?id=${courseId}`;
    } else {
      button.textContent = originalText;
      button.disabled = false;
      alert('❌ Enrollment failed: ' + response.message);
    }
  } catch (error) {
    console.error('Enrollment error:', error);
    const button = event.target;
    button.textContent = 'Enroll Now';
    button.disabled = false;
    alert('❌ Enrollment failed: ' + error.message);
  }
}

function showError(message) {
  const grid = document.querySelector('.courses-grid');
  if (grid) {
    grid.innerHTML = `
      <div class="error-message">
        <h3>⚠️ Error</h3>
        <p>${message}</p>
        <button onclick="loadCourses()" class="retry-btn">Try Again</button>
      </div>
    `;
  }
}

function checkAuthenticationStatus() {
  const token = localStorage.getItem('authToken');
  const userNav = document.querySelector('.user-nav');
  const authButtons = document.querySelector('.auth-buttons');
  
  if (token && userNav) {
    userNav.style.display = 'flex';
    if (authButtons) authButtons.style.display = 'none';
    
    const userData = localStorage.getItem('user');
    if (userData) {
      try {
        const user = JSON.parse(userData);
        const userAvatar = userNav.querySelector('.user-avatar');
        const userName = userNav.querySelector('.user-name');
        
        if (userAvatar) userAvatar.style.backgroundImage = `url('${user.avatar || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&q=80'}')`;
        if (userName) userName.textContent = user.name || user.email;
      } catch (e) {
        console.error('Error parsing user data:', e);
      }
    }
  } else {
    if (userNav) userNav.style.display = 'none';
    if (authButtons) authButtons.style.display = 'flex';
  }
}

async function logout() {
  try {
    await api.logout();
    localStorage.clear();
    sessionStorage.clear();
    alert('Logged out successfully');
    window.location.reload();
  } catch (error) {
    console.error('Logout error:', error);
    localStorage.clear();
    sessionStorage.clear();
    window.location.reload();
  }
}

document.addEventListener('DOMContentLoaded', () => {
  // Load courses on page load
  loadCourses();
  
  // Check authentication status
  checkAuthenticationStatus();

  // Setup filter buttons
  const filterBtns = document.querySelectorAll('.filter-btn');
  filterBtns.forEach(btn => {
    btn.addEventListener('click', function() {
      filterBtns.forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      loadCourses(this.textContent.trim());
    });
  });

  // Setup search functionality if search input exists
  const searchInput = document.getElementById('search-input');
  if (searchInput) {
    let searchTimeout;
    searchInput.addEventListener('input', function() {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(async () => {
        // Implement search functionality
        const searchTerm = this.value.trim();
        if (searchTerm) {
          try {
            const response = await api.search(searchTerm, 'courses');
            if (response.success && response.results.courses) {
              renderCourses(response.results.courses);
            }
          } catch (error) {
            console.error('Search error:', error);
          }
        } else {
          loadCourses();
        }
      }, 500);
    });
  }
});
    </script>
</body>
</html>